sigmar = 100;
wins = 2;
sigmas = 5;
filteriter = 1;
metric = 1000.0;

baseDir = '/home/cvlab/floorplan/reconstructions_filtered/mmcr/depth/';
baseDirNew = '/home/cvlab/floorplan/reconstructions_filtered/mmcr/depth_filtered/';
files = dir(fullfile(baseDir, '*.png'));
num_files = size(files);

for idx = 1 : num_files(1);
    D = imread([baseDir, files(idx).name]);
   % D = calc_depth(double(D));
    D = filterdepth(D, sigmar, wins, sigmas, filteriter, metric);
    Dint = uint16(round(D));
    imwrite(Dint,[baseDirNew, files(idx).name,])
end

    
%D = imread("/home/cvlab/floorplan/reconstructions/mmcr/depth/Depth0000.png")
%{
fx=525.0;
fy=525.0
base_addr='/home/cvlab/floorplan/final/learningsys/roomB/images/depth'; %mmcr_6Aug3
file_path=[base_addr,'/Depth0000.png']
depthmap=imread(file_path);
depthmap=double(depthmap);
imshow(depthmap)
[planes, ~, ~, ~, plparams2] = FindPlanesFromDepthMap_fiterror(depthmap./5000.0,(fx+fy)/2,1);
ind1=find(planes==1);
im1=zeros(size(planes));
im1(ind1)=depthmap(ind1);
imshow(im1)
%}